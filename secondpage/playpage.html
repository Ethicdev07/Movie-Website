<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamlab</title>
    <link rel="stylesheet" href="../otherpagecss/playpage.css">
    <link rel="shortcut icon" href="../images/asset-01.png" type="image/x-icon">
    <link href="https://fonts.cdnfonts.com/css/poppins" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.5.1/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.5.1/css/sharp-thin.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.5.1/css/sharp-solid.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.5.1/css/sharp-regular.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.5.1/css/sharp-light.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>

<body id="body">
    <div id="content" style="display: none;">
        <header class="header">
            <nav>
                <div class="logo">
                    <a href="../index.html"><img src="../images/asset-0.png" alt=""></a>
                </div>
                <div class="menu">
                    <ul>
                        <li class="home"><a href="" class="active">Home<span
                                    class="material-symbols-outlined">expand_more</span></a>
                            <div class="homedropdown">
                                <div class="items">
                                    <a href="">
                                        <div class="mainhome">Main Home</div>
                                        <div class="moviehome">Movies Home</div>
                                        <div class="tvshowhome">TV Shows Home</div>
                                        <div class="videohome">Video Home</div>
                                    </a>
                                </div>
                                <div class="itemsitems"></div>
                            </div>
                        </li>
                        <li><a href="" class="movies">Movies<span
                                    class="material-symbols-outlined">expand_more</span></a>
                            <div class="moviesdropdown">
                                <div class="items">
                                    <a href="">
                                        <div class="movies1">Movies List<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="movies1">Movies Genres<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="movies1">Single Movie<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <li><a href="" class="tvshows">TV Shows<span
                                    class="material-symbols-outlined">expand_more</span></a>
                            <div class="tvshowsdropdown">
                                <div class="items">
                                    <a href="">
                                        <div class="tvshowsstyle">TV Shows<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="tvshowsstyle">SingleTvShows<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="tvshowsstyle">Single Episode<spa class="material-symbols-outlined">
                                                keyboard_arrow_right</span></div>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <li><a href="" class="vidoes">Videos<span
                                    class="material-symbols-outlined">expand_more</span></a>
                            <div class="videosdropdown">
                                <div class="items">
                                    <a href="">
                                        <div class="vidoes1">Videos Style<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="vidoes1">Single Videos<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                    </a>
                                </div>
                            </div>
                        </li>
                        <li><a href="" class="blog">Pages<span class="material-symbols-outlined">expand_more</span></a>
                            <div class="blogdropdown">
                                <div class="items">
                                    <a href="">
                                        <div class="blog1">Blog<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="blog1">Pricing<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                        <div class="blog1">Contact Us<span
                                                class="material-symbols-outlined">keyboard_arrow_right</span></div>
                                    </a>
                                </div>
                            </div>
                        </li>
                    </ul>
                    <div class="sea">
                        <div class="search"><span class="material-symbols-outlined">search</span></div>
                        <div class="search-box">
                            <input type="text" class="search-input" placeholder="Search...">
                            <button class="search-btn"><span class="material-symbols-outlined">search</span></button>
                            <button class="cancel-btn"><span class="material-symbols-outlined">cancel</span></button>
                        </div>
                    </div>
                    <div class="per">
                        <div class="person" id="perBTN"><span class="material-symbols-outlined">person</span></div>
                        <div class="permenudropdown" id="menudropdown">
                            <div class="items">
                                <div class="login" id="logoutBTN"><span
                                        class="material-symbols-outlined">login</span>LogOut</div>
                                <div class="login"><span class="material-symbols-outlined">list</span>Library</div>
                                <div class="login"><span class="material-symbols-outlined">upload</span>Upload Video
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="but">
                        <button class="btn btn-primary" id="subBTN">Subscribe</button>
                    </div>
                    <div class="bar-drop" id="bardrop">
                        <i class="fa-solid fa-bars"></i>
                    </div>
                </div>
            </nav>
        </header>

        <div class="header2" id="header2">
            <div class="menu1" id="menulist">
                <ul>
                    <li class="home1"><a href="" class="active1">Home</a></li>
                    <li class="movies1"><a href="">Movies</a></li>
                    <li class="tvshows1"><a href="">Tv Shows</a></li>
                    <li class="video1"><a href="">Video</a></li>
                    <li class="pages1" id="subscribeBTN">Subscribe</li>
                </ul>
            </div>
        </div>

        <div class="play-contain contain">
            <img src="../images/play-background.jpg" alt="" class="play-img">

            <div class="play-text">
                <h2>Jumanji: Welcome to the Jungle</h2>

                <div class="rating">
                    <i class="bx bxs-star"></i>
                    <i class="bx bxs-star"></i>
                    <i class="bx bxs-star"></i>
                    <i class="bx bxs-star"></i>
                    <i class="bx bxs-star-half"></i>
                </div>

                <div class="tags">
                    <span>Action</span>
                    <span>Adventure</span>
                    <span>4K</span>
                </div>
            </div>
            <i class="bx bx-right-arrow play-movie"></i>

            <div class="video-contain">
                <div class="video-box">
                    <video id="myVideo" src="../videos/Jumanji.mp4" controls></video>

                    <i class="bx bx-x close-video"></i>
                </div>
            </div>
        </div>

        <div class="about-movie ">
            <h1>Jumanji: Welcome to the Jungle</h1>
            <p>
                Jumanji,the magical board game and ancient portal to its fearsome and savage jungles, gets an
                upgrade,this time luring four teens into its realm when one of them stumbles upon an old-school
                video-game console. Inevitably, as the unwitting players transform into their chosen game avatars inside
                a mysterious new world crawling with formidable adversaries, they'll need to put their newly-acquired
                skills to good use to finally complete game. The deep sound of the feral drums is incessant. Can the
                quirky quartet return to the physical world in one piece?
            </p>

            <h2 class="cast-heading">Movie Cast</h2>
            <div class="cast">
                <div class="cast-box">
                    <img src="../images/cast1.jpg" alt="" class="cast-img">
                    <span class="cast-title">Dwayne Johnson</span>
                </div>
                <div class="cast-box">
                    <img src="../images/cast2.jpg" alt="" class="cast-img">
                    <span class="cast-title">Karen Gillan</span>
                </div>
                <div class="cast-box">
                    <img src="../images/cast3.jpg" alt="" class="cast-img">
                    <span class="cast-title">Kevin Hart</span>
                </div>
                <div class="cast-box">
                    <img src="../images/cast4.jpg" alt="" class="cast-img">
                    <span class="cast-title">Jack Black</span>
                </div>
            </div>
        </div>

        <div class="download">
            <h2 class="download-title">Download Movie</h2>
            <div class="download-links">
                <a href="../videos/Jumanji.mp4" download>480p</a>
                <a href="../videos/Jumanji.mp4" download>780p</a>
                <a href="../videos/Jumanji.mp4" download>1180p</a>
            </div>
        </div>


        <section class="foot" id="foot">
            <div class="homefoot">
                <img src="../images/asset-0.png" alt="" class="footlogo">
            </div>
            <div class="foothead">
                <h2>Explore
                    <div class="exploremenu">
                        <div class="firstlist">
                            <ul>
                                <li><a href="">Home</a></li>
                                <li><a href="">TV Shows</a></li>
                                <li><a href="">Actions</a></li>
                                <li><a href="">Celebrities</a></li>
                            </ul>
                        </div>
                        <div class="secondlist">
                            <ul>
                                <li><a href="">Movies</a></li>
                                <li><a href="">Videos</a></li>
                                <li><a href="">Scenes</a></li>
                                <li><a href="">Cinemas</a></li>
                            </ul>
                        </div>
                    </div>
                </h2>
                <h2>Company
                    <div class="exploremenu">
                        <div class="firstlist">
                            <ul>
                                <li><a href="">Company</a></li>
                                <li><a href="">Terms Of Use</a></li>
                                <li><a href="">Contact Us</a></li>
                                <li><a href="">Our Team</a></li>
                            </ul>
                        </div>
                        <div class="secondlist">
                            <ul>
                                <li><a href="">Privacy Policy</a></li>
                                <li><a href="">Help Center</a></li>
                                <li><a href="">Subscribe</a></li>
                                <li><a href="">FAQ</a></li>
                            </ul>
                        </div>
                    </div>
                </h2>
                <h2>Download App
                    <div class="downloadtextimg">
                        <div class="downloadtext">
                            <span>Lorem ipsum dolor sit amet. <br> Suscipit, ea!</span>
                        </div>
                        <div class="downloadimage"></div>
                    </div>
                </h2>
            </div>
        </section>

        <section class="copyright">
            <p><a href="">Copyright 2024 Streamlab All Right Reserved.</a></p>
        </section>
    </div>

    <section class="dots-container" id="dots-container">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    </section>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous">
    </script>

<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
    import { getFirestore, collection, addDoc, doc, getDoc, getDocs, query, where, updateDoc } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAZdF_XPe6YzeOS9Y0wXgmjbB6LK917BiM",
        authDomain: "movie-webapp-f1fbc.firebaseapp.com",
        projectId: "movie-webapp-f1fbc",
        storageBucket: "movie-webapp-f1fbc.appspot.com",
        messagingSenderId: "884247801196",
        appId: "1:884247801196:web:b754aef28ff51c46091749"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const colRef = collection(db, "users");


    document.addEventListener("DOMContentLoaded", async function () {
        displaySpinner()
        displaySearchIcon()

    });

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            checkIfUserIsSubscribed(user)
        }
    });
    async function checkIfUserIsSubscribed(user) {
        // const user = auth.currentUser;
        const subBTN = document.getElementById('subBTN');
        console.log(user);
        if (user) {
            // const userDocRef = doc(colRef, user.id);
            const userDocSnap = await getDocs(query(colRef, where("email", "==", user.email)));
            userDocSnap.forEach(async (userDetails) => {
                const userData = userDetails.data();
                // console.log(userData);
                if (userData && userData.isSubscribed) {
                    subBTN.style.display = 'none';
                } else {
                    subBTN.style.display = 'block';
                }
            });
        }
    }

    subBTN.addEventListener('click', async function () {
        try {
            const user = auth.currentUser;
            const userEmail = user.email;
            if (userEmail) {
                const querySnapshot = await getDocs(query(colRef, where("email", "==", userEmail)));
                if (querySnapshot.isEmpty) {
                    console.log('Could not find doc');
                    return
                }
                querySnapshot.forEach(async (userDetails) => {
                    console.log(userDetails.data());
                    const docRef = doc(colRef, userDetails.id)
                    await updateDoc(docRef, { isSubscribed: true });
                });

                window.location.href = '../secondpage/subscribe.html'

            }

        } catch (error) {
            console.error('Error updating isSubscribed:', error);
        }

    });


    function displaySpinner() {
        setTimeout(function () {
            document.querySelector(".dots-container").style.display = "none";
            document.getElementById("content").style.display = "block";
        }, 3000);
    };

    perBTN.addEventListener('click', () => {
        menudropdown.classList.toggle("toggle")
    })

    function displaySearchIcon() {
        const searchIcon = document.querySelector('.search');
        const searchBox = document.querySelector('.search-box');
        const searchInput = document.querySelector('.search-input');
        const searchBtn = document.querySelector('.search-btn');
        const cancelBtn = document.querySelector('.cancel-btn');
        const searchSpan = document.querySelector('.search > span');

        searchIcon.addEventListener('click', function () {
            toggleSearch();
        });

        cancelBtn.addEventListener('click', function () {
            hideSearch();
        });

        searchBtn.addEventListener('click', function () {
            // Perform search functionality here
            // console.log('Searching for: ', searchInput.value);
        });

        function toggleSearch() {
            if (searchBox.style.display === 'none' || searchBox.style.display === '') {
                showSearch();
            } else {
                hideSearch();
            }
        }

        function showSearch() {
            searchBox.style.display = 'flex';
            searchInput.focus();
            searchSpan.classList.add('clicked');
            searchIcon.classList.add('search-icon-animate');
        }

        function hideSearch() {
            searchBox.style.display = 'none';
            searchInput.value = '';
            searchSpan.classList.remove('clicked');
            searchIcon.classList.remove('search-icon-animate');
        }
    };

    logoutBTN.addEventListener('click', function () {
        window.location.href = '../index.html'
    });

    bardrop.addEventListener('click', function () {
        if (header2.style.display === "block") {
            header2.style.opacity = "0";
            setTimeout(function () {
                header2.style.display = "none";
            }, 300);
            header2.style.display = "none";
        } else {
            header2.style.display = "block";
            setTimeout(function () {
                header2.style.opacity = "1";
            }, 50);
        }
    });



    subscribeBTN.addEventListener('click', function () {
        window.location.href = '../secondpage/subscribe.html'
    });

    let playButton = document.querySelector(".play-movie")
    let video = document.querySelector(".video-contain")
    let closeButton = document.querySelector(".close-video")
    let myVideo = document.querySelector("#myVideo")

    playButton.onclick = () => {
        video.classList.add("show-video");
        myVideo.play()
    };

    closeButton.onclick = () => {
        video.classList.remove("show-video");
        myVideo.pause()
    };

</script>

</html>